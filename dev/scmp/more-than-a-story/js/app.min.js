var morethanTitle, morethanDesc, morethanBg, videoandarticle;
$(function () {
    morethanTitle = new Swiper(".kewords", {
        direction: "vertical",
        allowTouchMove: !1,
        on: {
            init: function () {
                $(".title-first, .morethan-desc").addClass("active"), setTimeout(function () {
                    var e = $(".kewords .swiper-slide-active").width();
                    $(".kewords").css("width", e + "px")
                }, 1e3)
            }
        }
    }), morethanDesc = new Swiper(".morethandesc", {
        allowTouchMove: !1,
        effect: "fade"
    }), morethanBg = new Swiper(".morethanbg", {
        allowTouchMove: !1,
        effect: "fade"
    }), videoandarticle = new Swiper(".videoarticle", {
        allowTouchMove: !1
    }), morethanTitle.on("slideChangeTransitionStart", function () {
        var e = $(".kewords .swiper-slide-active").width();
        $(".kewords").css("width", e + "px")
    })
});
var articleList = [{
        episode: 1,
        video: "zvHf0ZwDvvw",
        editor: [{
            id: "fiona_sun",
            name: "Fiona Sun",
            title: "Reporter, SCMP’s Hong Kong desk",
            article: [{
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }]
        }, {
            id: "emily_tsang",
            name: "Emily Tsang",
            title: "News Editor, SCMP’s Hong Kong desk",
            article: [{
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }]
        }, {
            id: "zuraidah_ibrahim",
            name: "Zuraidah Ibrahim",
            title: " SCMP’s Executive Managing Editor",
            article: [{
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems."
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }, {
                thumb: "ex.jpg",
                link: "#",
                title: "Hong Kong Electoral Changes",
                desc: "How Beijing is leading an overhaul of Hong Kong’s election systems"
            }]
        }]
    }],
    SCMP = new Vue({
        el: "#scmp-app",
        data: {
            isIE: !1,
            isMob: !1,
            isSlide: !0,
            isShare: !1,
            ww: 0,
            wh: 0,
            sectionNav: !1,
            backtotop: !1,
            videos: ["zvHf0ZwDvvw", "mrxFY7_McR8", "apuzG9d2Czg"],
            articles: articleList
        },
        created: function () {
            this.getWindowSize()
        },
        mounted: function () {
            this.setScrollAni(), this.placeVideo(this.articles), $(window).scroll(function () {
                var e = $("#kv"),
                    o = e.offset().top,
                    t = e.offset().top + e.outerHeight(),
                    n = $(window).scrollTop() + $(window).innerHeight(),
                    i = $(window).scrollTop();
                n > o && i < t / 2 ? ($(".scmp-backtotop").addClass("pos-top"), $("#kv").removeClass("ani-pause"), $("#scmp-app").attr("data-section", "kv")) : ($("#kv").addClass("ani-pause"), $("#scmp-app").attr("data-section", "content"));
                var a = .01 * i;
                if (a < 5) return $(".kv-bg").css("filter", "blur(" + a + "px)"), !1
            }), setTimeout(function () {
                ScrollTrigger.refresh(), $(".swiper-slide").each(function () {
                    var e = $(this).width();
                    $(this).find(".text-wrap").css("width", e + "px")
                })
            }, 100), setTimeout(function () {
                ScrollTrigger.refresh()
            }, 1e3), $(window).resize(function () {
                ScrollTrigger.refresh(), SCMP.getWindowSize([$(window).width(), $(window).height()])
            })
        },
        watch: {
            isMob: function (e) {
                console.log(e)
            }
        },
        computed: {},
        methods: {
            checkIE: function () {
                var e = window.navigator.userAgent,
                    o = e.indexOf("MSIE "),
                    t = e.indexOf("Trident/");
                return o > 0 || t > 0
            },
            setScrollAni: function () {
                function e(e, o) {
                    gsap.to(window, {
                        scrollTo: {
                            y: e,
                            autoKill: !0,
                            ease: "expo.out"
                        },
                        duration: 1
                    })
                }

                function o(e) {
                    SCMP.backtotop || "complete" !== document.readyState || (gsap.set("body", {
                        overflow: "hidden"
                    }), gsap.to(window, {
                        scrollTo: {
                            y: e * innerHeight,
                            autoKill: !1,
                            ease: "Power3.easeInOut"
                        },
                        duration: .6,
                        onComplete: function () {
                            gsap.set("body", {
                                overflow: "auto"
                            })
                        }
                    }))
                }

                function t() {
                    var e = gsap.utils.toArray(".panel");
                    e.forEach(function (t, n) {
                        n < e.length - 1 && ScrollTrigger.create({
                            trigger: t,
                            start: "10% top",
                            onEnter: function () {
                                setTimeout(function () {
                                    o(n + 1), morethanTitle.slideTo(n + 1, 300), morethanDesc.slideTo(n + 1, 300), morethanBg.slideTo(n + 1, 1e3)
                                }, 100)
                            }
                        }), ScrollTrigger.create({
                            trigger: t,
                            start: "90% bottom",
                            onEnterBack: function () {
                                setTimeout(function () {
                                    o(n), morethanTitle.slideTo(n, 300), morethanDesc.slideTo(n, 300), morethanBg.slideTo(n, 1e3)
                                }, 100)
                            }
                        })
                    })
                }

                function n(e) {
                    var o, t = $(".video-holder[data-video=1]").find("iframe").attr("src");
                    "play" == e && (o = t.replace("autoplay=0", "autoplay=1")), "stop" == e && (o = t.replace("autoplay=1", "autoplay=0")), $('.video-holder[data-video="1"]').find("iframe").attr("src", o)
                }

                function i() {
                    gsap.utils.toArray(".area-conntent-btm").forEach(function () {
                        gsap.timeline({
                            scrollTrigger: {
                                trigger: ".area-conntent-btm",
                                start: "top bottom",
                                end: "bottom bottom",
                                scrub: !0,
                                onEnter: function () {
                                    $(".main-message").addClass("disable"), setTimeout(function () {
                                        SCMP.backtotop || "complete" !== document.readyState || (gsap.set("body", {
                                            overflow: "hidden"
                                        }), gsap.to(window, {
                                            scrollTo: {
                                                y: $(".area-conntent-btm").offset().top,
                                                autoKill: !1,
                                                ease: "Power3.easeInOut"
                                            },
                                            duration: .6,
                                            onComplete: function () {
                                                gsap.set("body", {
                                                    overflow: "auto"
                                                })
                                            }
                                        }))
                                    }, 100)
                                },
                                onLeaveBack: function () {
                                    $(".main-message").removeClass("disable")
                                }
                            }
                        })
                    }), gsap.utils.toArray(".article-group").forEach(function (e, o) {
                        gsap.to(e, {
                            scrollTrigger: {
                                trigger: e,
                                start: "top bottom-=100",
                                toggleActions: "play none none reverse"
                            }
                        }), ScrollTrigger.create({
                            trigger: e,
                            id: o + 1,
                            start: "top center",
                            end: function () {
                                return "+=" + e.clientHeight + 30
                            },
                            toggleActions: "play reverse none reverse",
                            toggleClass: {
                                targets: e,
                                className: "hello"
                            },
                            onEnter: function () {
                                $(e).addClass("active")
                            }
                        })
                    })
                }

                function a() {
                    gsap.utils.toArray("#video-n-article").forEach(function () {
                        a = gsap.timeline({
                            scrollTrigger: {
                                trigger: "#video-n-article",
                                start: "top bottom",
                                end: "bottom bottom",
                                scrub: !0,
                                onEnter: function () {
                                    n("play")
                                },
                                onLeaveBack: function () {
                                    n("stop")
                                }
                            }
                        })
                    })
                }

                function s() {
                    gsap.utils.toArray(".article-wrap").forEach(function () {
                        a = gsap.timeline({
                            scrollTrigger: {
                                trigger: ".article-wrap",
                                start: "top bottom",
                                end: "bottom bottom",
                                scrub: !0,
                                onEnter: function () {
                                    n("stop")
                                },
                                onLeaveBack: function () {
                                    n("play")
                                }
                            }
                        })
                    })
                }

                function r(e, o) {
                    var t = e > 752 ? "desktop" : "mobile";
                    t != d && (d = t, "mobile" === t ? (SCMP.isMob = !0, o > 900 && window.location.reload()) : "desktop" === t && (SCMP.isMob = !1, o > 900 && window.location.reload()))
                }
                var l = gsap.timeline({
                    scrollTrigger: {
                        trigger: "body",
                        scrub: .3,
                        start: "top top",
                        end: "bottom bottom"
                    }
                });
                l.to("#progress span", {
                    width: "100%",
                    ease: "none"
                }, 0).to("#progress", {
                    duration: .01,
                    opacity: 1,
                    ease: "none"
                }, 0);
                var a, s, c = gsap.from(".scmp-head", {
                        y: -70,
                        paused: !0,
                        duration: .3,
                        className: function () {
                            return "+=scmp-head head-toggle"
                        }
                    }).progress(1),
                    g = gsap.from(".scmp-backtotop", {
                        y: 70,
                        paused: !0,
                        duration: .3,
                        className: "+=scmp-backtotop pos-top"
                    }).progress(1);
                ScrollTrigger.create({
                    start: "top top",
                    end: 99999,
                    onUpdate: function (e) {
                        -1 === e.direction ? c.play() : (c.reverse(), setTimeout(function () {
                            SCMP.isShare = !1
                        }, 100)), -1 === e.direction ? g.play() : g.reverse()
                    }
                });
                var d = this.ww > 752 ? "desktop" : "mobile";
                this.ww < 752 ? this.isMob = !0 : this.isMob = !1;
                var u = null;
                window.addEventListener("scroll", function () {
                    null !== u && (clearTimeout(u), SCMP.moving = !0), u = setTimeout(function () {
                        SCMP.moving = !1
                    }, 100)
                }, !1), !1 === this.isMob && (t(), i(), a(), s(), console.log("desktop")), !0 === this.isMob && (console.log("mobile"), i()), $(".scmp-backtotop a").on("click", function (o) {
                    o.preventDefault();
                    var t = $(this).attr("href");
                    SCMP.backtotop = !0, e(t), setTimeout(function () {
                        SCMP.backtotop = !1
                    }, 1500)
                }), $(window).resize(function () {
                    r(SCMP.ww, SCMP.wh)
                })
            },
            openWindowAndShare: function (e) {
                var o, t = window.location.origin + window.location.pathname,
                    n = document.title,
                    i = $(window).width();
                i < 700 && (o = !0);
                var a = document.title.replace(/ /g, "+"),
                    s = encodeURI(a),
                    r = {
                        fb: "http://www.facebook.com/sharer.php?u=" + encodeURIComponent(t) + "%3Futm_source=facebook%26utm_medium=social_share%26utm_campaign=more_than_a_story_share&t=" + encodeURIComponent(n),
                        tw: "http://twitter.com/intent/tweet?text=" + s + "&url=" + window.location.origin + window.location.pathname + "%3Futm_source=tweeter%26utm_medium=social_share%26utm_campaign=more_than_a_story_share",
                        ln: "http://www.linkedin.com/shareArticle?mini=true&url=" + window.location.origin + window.location.pathname + "%3F%26utm_source%3Dlinkedin%26utm_medium%3Dsocial_share%26utm_campaign%3Dmore_than_a_story_share&source=more_than_a_story"
                    };
                return "facebook" === e && (o ? window.location.href = r.fb : window.open(r.fb, "sharer", "toolbar=0,status=0,width=626,height=436")), "twitter" === e && (o ? window.location.href = r.tw : window.open(r.tw, "twitter", "left=20,top=20,width=500,height=500,toolbar=1,resizable=0")), "linkedin" === e && (o ? window.location.href = r.ln : window.open(r.ln, "linkedin", "left=20,top=20,width=500,height=500,toolbar=1,resizable=0")), "email" === e && window.open("mailto:?subject=" + document.title + "&body=" + document.title + "%0D%0A" + window.location.origin + window.location.pathname + "%3Futm_source=email%26utm_medium=social_share%26utm_campaign=more_than_a_story", "email", "left=20,top=20,width=500,height=500,toolbar=1,resizable=0"), !1
            },
            gotoSection: function (e) {
                $("html, body").animate({
                    scrollTop: $(e).offset().top
                }, 500)
            },
            getWindowSize: function (e) {
                e ? (this.ww = e[0], this.wh = e[1]) : (this.ww = $(window).width(), this.wh = $(window).height())
            },
            openShareBtn: function () {
                !0 === this.isShare ? this.isShare = !1 : this.isShare = !0
            },
            placeVideo: function (e) {
                $(".video-holder").each(function (o) {
                    var t, n = new Number($(this).data("video")) - 1,
                        i = $(this).find(".video-holder-inner");
                    t = '<iframe type="text/html" src="https://www.youtube.com/embed/' + e[n].video + '?autoplay=0&controls=1&mute=1&playsinline=1&rel=0" frameborder="0" allow="autoplay"></iframe>', i.append(t)
                })
            }
        }
    });